import{c as ge,d as L,u as cs,a as _e,b as x,o as u,w as a,r as ce,n as be,g as ke,e,M as ds,f as us,h as Ne,i as t,_ as fs,m as Fe,j as Se,k as s,l as ms,p as ps,C as gs,q as k,s as $e,t as D,v as vs,x as ys,y as hs,z as ws,A as xs,B as _s,D as bs,E as F,F as J,G as ks,Z as Ns,H as Fs,I as Ss,J as S,K,L as v,N as $s,O as Ce,P as X,Q as Te,R as $,S as re,T as Cs,U as Ts,V as I,W as Is,X as As,Y as ne,$ as Ie,a0 as Ae,a1 as De,a2 as Pe,a3 as ye,a4 as Ds,a5 as Ps,a6 as Bs,a7 as Be,a8 as Me,a9 as Ee,aa as Ms,ab as Es,ac as ie,ad as ue,ae as fe,af as Rs,ag as Vs,ah as Ls,ai as Os,aj as js,ak as zs,al as Hs,am as Us,an as qs,ao as he,ap as Qs,aq as we,ar as Gs,as as le,at as Ys,au as Ws,av as W,aw as Js,ax as Ks,ay as z,az as se,aA as Xs,aB as Zs,aC as et,aD as st,aE as tt}from"./index-DIg-grGt.js";import{useNotaImport as at}from"./useNotaImport-q0bExQji.js";import{M as pe}from"./mail-BvkoJL8X.js";import{S as ot}from"./shield-XKKuUx3z.js";import{S as lt}from"./settings-2-C8ZGJs55.js";import{u as rt}from"./useStorageMode-C5FgiLp0.js";import{FileSystemBackend as xe}from"./fileSystemBackend-BaRlyXy9.js";import{s as nt}from"./directoryHandleStorage-CPjZxu3I.js";/**
 * @license lucide-vue-next v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=ge("FileUpIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-vue-next v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=ge("GithubIcon",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-vue-next v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=ge("TwitterIcon",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);var dt=L({__name:"DropdownMenuCheckboxItem",props:{modelValue:{type:[Boolean,String],required:!1},disabled:{type:Boolean,required:!1},textValue:{type:String,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["select","update:modelValue"],setup(g,{emit:m}){const o=g,c=cs(m);return _e(),(p,w)=>(u(),x(e(ds),be(ke({...o,...e(c)})),{default:a(()=>[ce(p.$slots,"default")]),_:3},16))}}),ut=dt,ft=L({__name:"DropdownMenuItemIndicator",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(g){const m=g;return _e(),(o,n)=>(u(),x(e(us),be(ke(m)),{default:a(()=>[ce(o.$slots,"default")]),_:3},16))}}),mt=ft;const pt={class:"flex items-center justify-center py-10"},gt=L({__name:"TableEmpty",props:{class:{},colspan:{default:1}},setup(g){const m=g,o=Ne(m,"class");return(n,c)=>(u(),x(ms,null,{default:a(()=>[t(fs,Fe({class:e(Se)("p-4 whitespace-nowrap align-middle text-sm text-foreground",m.class)},e(o)),{default:a(()=>[s("div",pt,[ce(n.$slots,"default")])]),_:3},16,["class"])]),_:3}))}}),vt={class:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"},yt=L({__name:"DropdownMenuCheckboxItem",props:{modelValue:{type:[Boolean,String]},disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{}},emits:["select","update:modelValue"],setup(g,{emit:m}){const o=g,n=m,c=Ne(o,"class"),p=ps(c,n);return(w,f)=>(u(),x(e(ut),Fe(e(p),{class:e(Se)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",o.class)}),{default:a(()=>[s("span",vt,[t(e(mt),null,{default:a(()=>[t(e(gs),{class:"w-4 h-4"})]),_:1})]),ce(w.$slots,"default")]),_:3},16,["class"]))}});function ht(){const g=k(!1),m=$e();return{isSubscribing:g,subscribeToNewsletter:async()=>{if(g.value)return!1;if(!m.currentUser)return D("You must be logged in to subscribe to the newsletter.",{description:"Authentication Required"}),!1;g.value=!0;try{const n=m.currentUser,c=vs(ys,"newsletterSubscriptions",n.uid);return await hs(c,{email:n.email,displayName:n.displayName||"",subscribedAt:ws(),uid:n.uid}),D("ðŸŽ‰ You have successfully subscribed to the newsletter!",{description:"Subscription Successful"}),!0}catch(n){return console.error("Error subscribing to newsletter:",n),D("There was an error subscribing. Please try again.",{description:"Subscription Failed"}),!1}finally{g.value=!1}}}}const wt={class:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-br from-orange-500 to-red-500 text-white shadow-lg"},xt={class:"space-y-2"},_t={class:"grid grid-cols-1 gap-3 my-4"},bt={class:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg"},kt={class:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg"},Nt={class:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg"},Ft={class:"font-semibold"},St=L({__name:"NewsletterModal",props:{open:{type:Boolean}},emits:["update:open"],setup(g,{emit:m}){const o=m,{subscribeToNewsletter:n,isSubscribing:c}=ht(),p=async()=>{await n()&&o("update:open",!1)};return(w,f)=>(u(),x(e($s),{open:w.open,"onUpdate:open":f[0]||(f[0]=C=>o("update:open",C))},{default:a(()=>[t(e(xs),{class:"sm:max-w-lg"},{default:a(()=>[t(e(_s),{class:"text-center space-y-4"},{default:a(()=>[s("div",wt,[t(e(pe),{class:"h-8 w-8"})]),s("div",xt,[t(e(bs),{class:"text-2xl font-bold bg-gradient-to-r from-orange-500 to-red-500 bg-clip-text text-transparent"},{default:a(()=>f[1]||(f[1]=[F(" Escape Technofeudalism ")])),_:1}),t(e(J),{variant:"outline",class:"mx-auto text-xs"},{default:a(()=>f[2]||(f[2]=[F(" Weekly Rebellion Digest ")])),_:1})]),t(e(ks),{class:"text-left space-y-4 text-muted-foreground leading-relaxed"},{default:a(()=>[f[6]||(f[6]=s("p",{class:"text-foreground font-medium"}," Tired of being a free-tier serf, selling your soul and data to the platform overlords? ",-1)),f[7]||(f[7]=s("p",null," Join the resistance. Our newsletter delivers your weekly dose of digital independence, packed with: ",-1)),s("div",_t,[s("div",bt,[t(e(Ns),{class:"h-5 w-5 text-yellow-500 flex-shrink-0"}),f[3]||(f[3]=s("span",{class:"text-sm"},"Open-source tools and BashNota updates",-1))]),s("div",kt,[t(e(ot),{class:"h-5 w-5 text-green-500 flex-shrink-0"}),f[4]||(f[4]=s("span",{class:"text-sm"},"Privacy-first development tips",-1))]),s("div",Nt,[t(e(Fs),{class:"h-5 w-5 text-orange-500 flex-shrink-0"}),f[5]||(f[5]=s("span",{class:"text-sm"},"Developer humor & occasional GIFs",-1))])]),f[8]||(f[8]=s("p",{class:"text-xs text-muted-foreground text-center"}," No spam, no data harvesting, just pure knowledge for independent minds. ",-1))]),_:1})]),_:1}),t(e(Ss),{class:"mt-6 space-y-3"},{default:a(()=>[t(e(S),{onClick:p,class:"w-full h-12 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02]",disabled:e(c)},{default:a(()=>[e(c)?(u(),x(e(K),{key:0,class:"mr-2 h-4 w-4 rounded-full"})):(u(),x(e(pe),{key:1,class:"mr-2 h-4 w-4"})),s("span",Ft,v(e(c)?"Joining the Resistance...":"Join the Resistance"),1)]),_:1},8,["disabled"]),f[9]||(f[9]=s("p",{class:"text-xs text-center text-muted-foreground"}," Unsubscribe anytime. Your data stays yours. ",-1))]),_:1})]),_:1})]),_:1},8,["open"]))}}),$t={class:"max-w-lg mx-auto space-y-8 p-6"},Ct={class:"text-center space-y-6"},Tt={class:"space-y-3"},It={class:"text-muted-foreground mt-1"},At={class:"space-y-4"},Dt={class:"flex items-center gap-3"},Pt={class:"p-1 bg-white/20 rounded-lg"},Bt={class:"flex gap-3"},Mt={key:0,class:"font-medium"},Et={key:1,class:"font-medium"},Rt={class:"font-medium"},Vt={class:"flex justify-center gap-3 flex-wrap"},Lt={class:"text-xs font-medium text-muted-foreground"},Ot={class:"text-xs font-medium text-muted-foreground"},jt=L({__name:"HomeHeader",props:{isFilesystemMode:{type:Boolean},hasDirectoryAccess:{type:Boolean},directoryName:{}},emits:["create-nota","select-directory"],setup(g,{emit:m}){const o=m,n=$e(),c=Ce(),p=k(!1),{importNota:w,importJupyterNotebook:f,isImporting:C}=at(),A=k(null),P=k(!1),d=k(null),N=k(!1),b=()=>{o("create-nota")},H=()=>{c.push("/login")},R=()=>{window.open("https://github.com/bashnota/bashnota","_blank")},V=()=>{window.open("https://twitter.com/bashnota","_blank")},U=async()=>{try{P.value=!0;const h=await fetch("https://api.github.com/repos/bashnota/bashnota");if(h.ok){const r=await h.json();A.value=r.stargazers_count}}catch(h){console.error("Failed to fetch GitHub stars:",h)}finally{P.value=!1}},B=async()=>{try{N.value=!0,d.value=null}catch(h){console.error("Failed to fetch Twitter followers:",h)}finally{N.value=!1}},O=async()=>{await w([Bs.nota])},Z=async()=>{await f()},q=()=>{o("select-directory")},M=X(()=>{var r;const h=(r=n.currentUser)==null?void 0:r.displayName;return h?`Welcome back, ${h}!`:""}),j=X(()=>A.value===null?null:A.value>=1e3?`${(A.value/1e3).toFixed(1)}k`:A.value.toString()),Q=X(()=>d.value===null?null:d.value>=1e3?`${(d.value/1e3).toFixed(1)}k`:d.value.toString());return Te(()=>{U(),B()}),(h,r)=>(u(),$(re,null,[s("div",$t,[s("div",Ct,[s("div",Tt,[r[3]||(r[3]=s("div",{class:"inline-flex items-center justify-center p-3 bg-gradient-to-br from-primary/10 to-primary/5 rounded-2xl border border-primary/20 shadow-sm"},[s("img",{src:Cs,alt:"BashNota Logo",class:"h-8 w-8"})],-1)),s("div",null,[r[2]||(r[2]=s("h1",{class:"text-3xl font-bold text-foreground tracking-tight"},"BashNota",-1)),s("p",It,v(M.value),1)])]),r[4]||(r[4]=s("div",{class:"space-y-3"},[s("h2",{class:"text-xl font-semibold text-foreground leading-tight"}," Your second brain, cracked on code and AI "),s("p",{class:"text-muted-foreground leading-relaxed max-w-sm mx-auto"}," Build extensions, own your data, break free from platform lock-in. Open source tools for independent minds. ")],-1))]),s("div",At,[t(e(S),{onClick:b,class:"w-full h-14 bg-primary hover:bg-primary/90 text-primary-foreground shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02]",size:"lg"},{default:a(()=>[s("div",Dt,[s("div",Pt,[t(e(Ts),{class:"h-5 w-5"})]),r[5]||(r[5]=s("div",{class:"text-left"},[s("div",{class:"font-semibold text-base"},"Create a Nota")],-1))])]),_:1}),s("div",Bt,[e(n).isAuthenticated?I("",!0):(u(),x(e(S),{key:0,onClick:H,variant:"outline",class:"flex-1 h-12 hover:bg-muted/50 transition-colors"},{default:a(()=>[t(e(Is),{class:"h-4 w-4 mr-2"}),r[6]||(r[6]=s("span",{class:"font-medium"},"Sign In",-1))]),_:1})),h.isFilesystemMode?(u(),x(e(S),{key:1,onClick:q,variant:"outline",class:ne([e(n).isAuthenticated?"flex-1":"flex-[0.8]","h-12 hover:bg-muted/50 transition-colors"])},{default:a(()=>[t(e(As),{class:"h-4 w-4 mr-2"}),h.hasDirectoryAccess&&h.directoryName?(u(),$("span",Mt,v(h.directoryName),1)):(u(),$("span",Et," Select Directory "))]),_:1},8,["class"])):I("",!0),t(e(Ie),null,{default:a(()=>[t(e(Ae),{asChild:""},{default:a(()=>[t(e(S),{variant:"outline",class:ne([h.isFilesystemMode?"flex-[0.6]":e(n).isAuthenticated?"flex-1":"flex-[0.6]","h-12 hover:bg-muted/50 transition-colors"]),disabled:e(C)},{default:a(()=>[t(e(me),{class:"h-4 w-4 mr-2"}),s("span",Rt,v(e(C)?"Importing...":"Import"),1),t(e(De),{class:"h-3 w-3 ml-1"})]),_:1},8,["class","disabled"])]),_:1}),t(e(Pe),{align:"end",class:"w-48"},{default:a(()=>[t(e(ye),{onClick:O,class:"cursor-pointer",disabled:e(C)},{default:a(()=>[t(e(me),{class:"h-4 w-4 mr-2"}),r[7]||(r[7]=s("div",{class:"flex-1"},[s("div",{class:"font-medium text-sm"},"Import Nota"),s("div",{class:"text-xs text-muted-foreground"},".nota files")],-1))]),_:1},8,["disabled"]),t(e(ye),{onClick:Z,class:"cursor-pointer",disabled:e(C)},{default:a(()=>[t(e(me),{class:"h-4 w-4 mr-2"}),r[8]||(r[8]=s("div",{class:"flex-1"},[s("div",{class:"font-medium text-sm"},"Import Notebook"),s("div",{class:"text-xs text-muted-foreground"},"Jupyter .ipynb files")],-1))]),_:1},8,["disabled"])]),_:1})]),_:1}),e(n).isAuthenticated?(u(),x(e(S),{key:2,onClick:r[0]||(r[0]=_=>p.value=!0),variant:"outline",class:"flex-[0.8] h-12 hover:bg-muted/50 transition-colors group"},{default:a(()=>[t(e(pe),{class:"h-4 w-4 mr-2"}),r[9]||(r[9]=s("span",{class:"font-medium"},"Newsletter",-1))]),_:1})):I("",!0),t(e(S),{onClick:R,variant:"outline",class:ne([e(n).isAuthenticated?"flex-[0.5]":"flex-[0.3]","h-12 hover:bg-muted/50 transition-colors group"])},{default:a(()=>[t(e(it),{class:"h-4 w-4 mr-2"}),r[10]||(r[10]=s("span",{class:"font-medium"},"Contribute",-1)),t(e(Ds),{class:"h-3 w-3 ml-1 opacity-60 group-hover:opacity-100 transition-opacity"})]),_:1},8,["class"])])]),s("div",Vt,[A.value!==null||P.value?(u(),$("div",{key:0,class:"inline-flex items-center gap-2 px-3 py-1.5 bg-muted/50 rounded-full border border-border/50 hover:bg-muted/70 transition-colors cursor-pointer",onClick:R},[t(e(Ps),{class:"h-3 w-3 text-yellow-500 fill-yellow-500"}),s("span",Lt,v(P.value?"...":j.value)+" stars ",1)])):I("",!0),s("div",{class:"inline-flex items-center gap-2 px-3 py-1.5 bg-muted/50 rounded-full border border-border/50 hover:bg-muted/70 transition-colors cursor-pointer",onClick:V},[t(e(ct),{class:"h-3 w-3 text-blue-500"}),s("span",Ot,v(N.value?"...":d.value!==null?`${Q.value} followers`:"Follow @bashnota"),1)]),r[11]||(r[11]=s("div",{class:"inline-flex items-center gap-2 px-3 py-1.5 bg-muted/50 rounded-full border border-border/50"},[s("div",{class:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),s("span",{class:"text-xs font-medium text-muted-foreground"}," Open Source & Privacy First ")],-1))])]),t(St,{open:p.value,"onUpdate:open":r[1]||(r[1]=_=>p.value=_)},null,8,["open"])],64))}}),zt=Be(jt,[["__scopeId","data-v-c1a4d4f6"]]),Ht={class:"flex flex-col h-full space-y-4"},Ut={class:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between"},qt={class:"flex items-center gap-2"},Qt={class:"flex flex-col gap-2 sm:flex-row sm:items-center"},Gt={key:0,class:"mt-3 pt-3 border-t space-y-3"},Yt={class:"flex flex-wrap items-center gap-2 text-sm"},Wt={class:"flex items-center gap-1"},Jt={class:"flex items-center justify-between w-full"},Kt={class:"flex items-center justify-between w-full"},Xt={class:"flex items-center gap-1"},Zt={class:"p-3 border-b bg-muted/30"},ea={class:"flex items-center justify-between"},sa={class:"flex items-center gap-2 text-sm text-muted-foreground"},ta={class:"flex items-center gap-3"},aa={key:0,class:"flex items-center gap-2"},oa={class:"text-xs text-muted-foreground"},la={key:1,class:"p-8"},ra={class:"space-y-4"},na={key:2,class:"max-h-[600px] overflow-y-auto"},ia={class:"text-center py-8"},ca={class:"text-muted-foreground"},da={class:"flex items-center justify-between"},ua={class:"text-sm text-muted-foreground"},fa={class:"flex items-center gap-1"},ma={key:1,class:"px-2 text-muted-foreground"},pa=L({__name:"HomeNotaList",props:{isLoading:{type:Boolean},showFavorites:{type:Boolean},searchQuery:{},selectedTag:{},notas:{},totalCount:{},filesystemNotas:{},isFilesystemMode:{type:Boolean},hasDirectoryAccess:{type:Boolean}},emits:["create-nota","update:selectedTag","clear-filters","update:searchQuery","update:showFavorites","page-change"],setup(g,{emit:m}){const o=g,n=m,c=Ce(),p=Me(),{toggleNotaFavorite:w}=Ee(),{isProcessing:f,batchToggleFavorite:C,batchDelete:A,batchAddTags:P,batchRemoveTags:d}=Ms(),{localSearchQuery:N,selectedQuickFilters:b,selectedTags:H,viewFilter:R,filterOptions:V,availableTags:U,activeFiltersCount:B,currentSortOption:O,sortDirection:Z,hasSelection:q,selectionCount:M,currentPage:j,totalPages:Q,paginatedItems:h,paginationInfo:r,getVisiblePages:_,goToPage:E,nextPage:Re,previousPage:Ve,isAllSelected:Le,isIndeterminate:Oe,handleSelectAll:je,updateSearch:ze,toggleQuickFilter:He,toggleTag:Ue,handleSort:ve,handleSelectNota:qe,isNotaSelected:Qe,clearSelection:G,getSelectedIds:Ge,getSelectedNotas:Ye,clearAllFilters:We,formatDate:Je,SORT_OPTIONS:Ke}=Es({notas:()=>o.notas,initialSearchQuery:o.searchQuery,showFavorites:()=>o.showFavorites,itemsPerPage:10,onSearchUpdate:y=>n("update:searchQuery",y),onFiltersChange:()=>n("clear-filters")}),Xe=k(null),Ze=k(!1),te=k(!1),es=y=>{if(!o.isFilesystemMode||!o.filesystemNotas)return!1;const l=o.filesystemNotas.some(T=>T.id===y),i=p.items.some(T=>T.id===y);return l&&!i},ss=()=>{We(),G(),n("clear-filters"),n("update:selectedTag",""),n("update:showFavorites",!1)},ts=y=>{Xe.value=y,Ze.value=!0},as=y=>{c.push(`/nota/${y.id}`)},os=async y=>{const l=await C(y,o.notas,async i=>{await w(i)});l.success&&G(),console.log(l.message)},ls=async y=>{const l=await A(y,async i=>{await p.deleteItem(i)});l.success&&G(),console.log(l.message)},rs=async(y,l)=>{const i=await P(y,l,async(T,oe)=>{const ee=o.notas.find(Y=>Y.id===T);if(ee){const Y=ee.tags||[],de=[...new Set([...Y,...oe])];await p.updateNota(T,{tags:de})}});i.success&&G(),console.log(i.message)},ns=async(y,l)=>{const i=await d(y,l,async(T,oe)=>{const ee=o.notas.find(Y=>Y.id===T);if(ee){const de=(ee.tags||[]).filter(is=>!oe.includes(is));await p.updateNota(T,{tags:de})}});i.success&&G(),console.log(i.message)},ae=X(()=>B.value>0||o.selectedTag!=="");return ie(()=>o.searchQuery,y=>{y!==N.value&&(N.value=y)}),ie(()=>o.showFavorites,y=>{y?b.value.add("favorites"):b.value.delete("favorites")}),(y,l)=>(u(),$("div",Ht,[t(e(ue),{class:"border-l-primary/30"},{default:a(()=>[t(e(fe),{class:"p-4"},{default:a(()=>[s("div",Ut,[s("div",qt,[t(e(Rs),{class:"h-4 w-4"}),l[6]||(l[6]=s("span",{class:"font-semibold"},"Notas",-1)),t(e(J),{variant:"secondary",class:"text-xs"},{default:a(()=>[F(v(e(h).length),1)]),_:1}),ae.value?(u(),x(e(J),{key:0,variant:"outline",class:"text-xs border-primary/50 text-primary"},{default:a(()=>[F(v(e(B))+" filter"+v(e(B)>1?"s":"")+" active ",1)]),_:1})):I("",!0)]),s("div",Qt,[t(Vs,{"model-value":e(N),placeholder:"Search notas...","onUpdate:modelValue":e(ze),class:"w-full sm:w-64"},null,8,["model-value","onUpdate:modelValue"]),t(e(S),{variant:"outline",size:"sm",class:ne(["h-8",{"bg-primary/10 text-primary":te.value}]),onClick:l[0]||(l[0]=i=>te.value=!te.value)},{default:a(()=>[t(e(Ls),{class:"h-3 w-3 mr-1"}),l[7]||(l[7]=F(" Filters ")),e(B)?(u(),x(e(J),{key:0,variant:"secondary",class:"ml-1 h-4 text-xs"},{default:a(()=>[F(v(e(B)),1)]),_:1})):I("",!0)]),_:1},8,["class"])])]),te.value?(u(),$("div",Gt,[t(Os,{filters:e(V),"selected-filters":e(b),onToggleFilter:e(He)},null,8,["filters","selected-filters","onToggleFilter"]),s("div",Yt,[s("div",Wt,[l[10]||(l[10]=s("span",{class:"text-muted-foreground text-xs"},"View:",-1)),t(e(js),{value:e(R),"onUpdate:value":l[1]||(l[1]=i=>zs(R)?R.value=i:null)},{default:a(()=>[t(e(Hs),{class:"w-28 h-6 text-xs"},{default:a(()=>[t(e(Us))]),_:1}),t(e(qs),null,{default:a(()=>[t(e(he),{value:"all"},{default:a(()=>[s("div",Jt,[l[8]||(l[8]=s("span",null,"All",-1)),t(e(J),{variant:"secondary",class:"ml-1 text-xs"},{default:a(()=>[F(v(o.notas.length),1)]),_:1})])]),_:1}),t(e(he),{value:"favorites"},{default:a(()=>[s("div",Kt,[l[9]||(l[9]=s("span",null,"Favorites",-1)),t(e(J),{variant:"secondary",class:"ml-1 text-xs"},{default:a(()=>[F(v(o.notas.filter(i=>i.favorite).length),1)]),_:1})])]),_:1})]),_:1})]),_:1},8,["value"])]),t(Qs,{tags:e(U),"selected-tags":e(H),onToggleTag:e(Ue)},null,8,["tags","selected-tags","onToggleTag"]),s("div",Xt,[t(e(lt),{class:"h-3 w-3 text-muted-foreground"}),l[11]||(l[11]=s("span",{class:"text-muted-foreground text-xs"},"Sort:",-1)),t(e(Ie),null,{default:a(()=>[t(e(Ae),{"as-child":""},{default:a(()=>[t(e(S),{variant:"outline",size:"sm",class:"h-6 px-2 text-xs"},{default:a(()=>{var i;return[F(v(((i=e(O))==null?void 0:i.label)||"Sort")+" ",1),t(e(De),{class:"h-3 w-3 ml-1"})]}),_:1})]),_:1}),t(e(Pe),null,{default:a(()=>[(u(!0),$(re,null,we(e(Ke),i=>{var T;return u(),x(e(yt),{key:i.key,checked:((T=e(O))==null?void 0:T.key)===i.key,onClick:oe=>e(ve)(i.key)},{default:a(()=>[F(v(i.label),1)]),_:2},1032,["checked","onClick"])}),128))]),_:1})]),_:1})]),ae.value?(u(),x(e(S),{key:0,variant:"ghost",size:"sm",class:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground",onClick:ss},{default:a(()=>[t(e(Gs),{class:"h-3 w-3 mr-1"}),l[12]||(l[12]=F(" Clear All "))]),_:1})):I("",!0)])])):I("",!0)]),_:1})]),_:1}),t(e(ue),null,{default:a(()=>[t(e(fe),{class:"p-0"},{default:a(()=>[s("div",Zt,[s("div",ea,[s("div",sa,[t(e(le),{class:"h-4 w-4"}),s("span",null," Showing "+v(e(r).startItem)+"-"+v(e(r).endItem)+" of "+v(e(r).totalItems)+" notas ",1)]),s("div",ta,[e(q)?(u(),$("div",aa,[s("span",oa,v(e(M))+" selected",1)])):I("",!0),t(e(S),{variant:"default",size:"sm",class:"h-7",onClick:l[2]||(l[2]=i=>n("create-nota"))},{default:a(()=>[t(e(le),{class:"h-3 w-3 mr-1"}),l[13]||(l[13]=F(" New Nota "))]),_:1})])])]),e(q)?(u(),x(Ys,{key:0,"selected-count":e(M),"selected-ids":e(Ge)(),"selected-notas":e(Ye)(o.notas),"all-tags":e(U),"is-processing":e(f),onBatchToggleFavorite:os,onBatchDelete:ls,onBatchAddTags:rs,onBatchRemoveTags:ns,onClearSelection:e(G)},null,8,["selected-count","selected-ids","selected-notas","all-tags","is-processing","onClearSelection"])):I("",!0),y.isLoading?(u(),$("div",la,[s("div",ra,[t(e(K),{class:"h-8 w-full"}),t(e(K),{class:"h-8 w-full"}),t(e(K),{class:"h-8 w-full"}),t(e(K),{class:"h-8 w-full"}),t(e(K),{class:"h-8 w-full"})])])):e(h).length>0?(u(),$("div",na,[t(Ws,{notas:e(h),"current-sort-option":e(O),"sort-direction":e(Z),"is-all-selected":e(Le),"is-indeterminate":e(Oe),"format-date":e(Je),"is-nota-selected":e(Qe),"is-filesystem-nota":y.isFilesystemMode?es:void 0,mode:"list",onSort:e(ve),onSelectAll:e(je),onSelectNota:e(qe),onNotaClick:as,onPreviewNota:ts,onToggleFavorite:e(w),onDeleteNota:l[3]||(l[3]=i=>e(p).deleteItem(i)),onTagClick:l[4]||(l[4]=i=>n("update:selectedTag",i))},null,8,["notas","current-sort-option","sort-direction","is-all-selected","is-indeterminate","format-date","is-nota-selected","is-filesystem-nota","onSort","onSelectAll","onSelectNota","onToggleFavorite"])])):(u(),x(e(gt),{key:3},{default:a(()=>[s("div",ia,[t(e(le),{class:"mx-auto h-12 w-12 text-muted-foreground/50"}),l[15]||(l[15]=s("h3",{class:"mt-4 text-lg font-semibold"},"No notas found",-1)),s("p",ca,v(ae.value?"Try adjusting your filters":"Create your first nota to get started"),1),ae.value?I("",!0):(u(),x(e(S),{key:0,class:"mt-4",onClick:l[5]||(l[5]=i=>n("create-nota"))},{default:a(()=>[t(e(le),{class:"h-4 w-4 mr-2"}),l[14]||(l[14]=F(" Create Nota "))]),_:1}))])]),_:1}))]),_:1})]),_:1}),e(Q)>1?(u(),x(e(ue),{key:0},{default:a(()=>[t(e(fe),{class:"p-4"},{default:a(()=>[s("div",da,[s("div",ua," Showing "+v(e(r).startItem)+" to "+v(e(r).endItem)+" of "+v(e(r).totalItems)+" entries ",1),s("div",fa,[t(e(S),{variant:"outline",size:"sm",disabled:e(j)===1,onClick:e(Ve)},{default:a(()=>l[16]||(l[16]=[F(" Previous ")])),_:1},8,["disabled","onClick"]),(u(!0),$(re,null,we(e(_)(),i=>(u(),$(re,{key:i},[typeof i=="number"?(u(),x(e(S),{key:0,variant:i===e(j)?"default":"outline",size:"sm",class:"w-9",onClick:T=>e(E)(i)},{default:a(()=>[F(v(i),1)]),_:2},1032,["variant","onClick"])):(u(),$("span",ma,v(i),1))],64))),128)),t(e(S),{variant:"outline",size:"sm",disabled:e(j)===e(Q),onClick:e(Re)},{default:a(()=>l[17]||(l[17]=[F(" Next ")])),_:1},8,["disabled","onClick"])])])]),_:1})]),_:1})):I("",!0)]))}});function ga(){const g=W(z.preferences.viewType,"grid"),m=W(z.preferences.activeView,"notas"),o=W(z.preferences.showFavorites,!1),n=W(z.preferences.lastSearch,""),c=W(z.preferences.lastTag,""),p=W(z.preferences.layoutPreferences,{showAnalytics:!0,showRecommendations:!0,compactMode:!1,sidebarWidth:"normal"}),w=k(1);return ie([o,n,c],()=>{w.value=1}),{viewType:g,activeView:m,showFavorites:o,searchQuery:n,selectedTag:c,layoutPreferences:p,currentPage:w,clearFilters:()=>{o.value=!1,n.value="",c.value="",w.value=1},resetPreferences:()=>{g.value="grid",m.value="notas",o.value=!1,n.value="",c.value="",w.value=1,p.value={showAnalytics:!0,showRecommendations:!0,compactMode:!1,sidebarWidth:"normal"}},STORAGE_KEYS:z.preferences,VIEW_TYPES:Ks,ACTIVE_VIEWS:Js}}function va(){const{isFilesystemMode:g,getDirectoryHandle:m}=rt(),o=k([]),n=k(!1),c=k(!1),p=k(null),w=async()=>{if(!g.value){c.value=!1;return}try{const d=m();d?(c.value=!0,p.value=d.name):c.value=!1}catch(d){se.error("[useFilesystemNotas] Failed to check directory access:",d),c.value=!1}},f=async()=>{if(!g.value){o.value=[];return}n.value=!0;try{const d=new xe;if(await xe.hasPersistedHandle()){await d.initialize();const N=await d.listNotas();o.value=N;const b=d.getDirectoryHandle();b&&(p.value=b.name,c.value=!0),se.info(`[useFilesystemNotas] Loaded ${N.length} notas from filesystem`)}else o.value=[],c.value=!1}catch(d){se.error("[useFilesystemNotas] Failed to load filesystem notas:",d),o.value=[],c.value=!1}finally{n.value=!1}};return{filesystemNotas:o,isLoadingFilesystem:n,hasDirectoryAccess:c,directoryName:p,isFilesystemMode:g,checkDirectoryAccess:w,loadFilesystemNotas:f,selectDirectory:async()=>{if(!g.value)return D.error("Filesystem mode is not enabled",{description:"Please enable filesystem mode in Settings > Advanced > Storage Mode"}),!1;try{if(!("showDirectoryPicker"in window))return D.error("File System Access API not supported",{description:"Your browser does not support this feature"}),!1;const d=await window.showDirectoryPicker({mode:"readwrite",startIn:"documents"});return se.info("[useFilesystemNotas] Directory selected:",d.name),await nt(d),p.value=d.name,c.value=!0,await f(),D.success("Directory selected",{description:`Selected directory: ${d.name}`}),!0}catch(d){return se.error("[useFilesystemNotas] Failed to select directory:",d),d.name==="AbortError"?D.info("Directory selection cancelled"):D.error("Failed to select directory",{description:"Could not access the file system. Please check your browser permissions."}),!1}},getFilesystemOnlyNotas:d=>{const N=new Set(d.map(b=>b.id));return o.value.filter(b=>!N.has(b.id))},getSharedNotas:d=>{const N=new Set(d.map(b=>b.id));return o.value.filter(b=>N.has(b.id))}}}const ya={class:"flex flex-col w-full h-screen lg:h-screen bg-background overflow-hidden lg:overflow-hidden"},ha={class:"flex-1 overflow-auto lg:overflow-hidden h-full w-full"},wa={class:"container max-w-full px-3 sm:px-4 lg:px-6 h-full py-4 sm:py-6 lg:h-full lg:overflow-hidden"},xa={class:"grid grid-cols-1 lg:grid-cols-5 gap-4 sm:gap-6 h-full w-full max-w-full lg:h-full lg:overflow-hidden"},_a={class:"lg:col-span-2 flex flex-col h-auto lg:h-full lg:min-h-0 w-full min-w-0"},ba={class:"flex-1 lg:overflow-y-auto lg:overflow-x-hidden lg:scrollbar-thin lg:scrollbar-thumb-muted lg:scrollbar-track-background w-full"},ka={class:"lg:col-span-3 flex flex-col h-auto lg:h-full lg:min-h-0 w-full min-w-0"},Na={class:"flex flex-col h-auto lg:h-full w-full min-w-0"},Fa=3,Sa=L({__name:"HomeView",setup(g){const m=Me(),o=k(!0),n=k(!1),c=k(null),p=k(0),{viewType:w,showFavorites:f,searchQuery:C,selectedTag:A,clearFilters:P}=ga(),{createNewNota:d}=Ee(),{filesystemNotas:N,isLoadingFilesystem:b,hasDirectoryAccess:H,directoryName:R,isFilesystemMode:V,checkDirectoryAccess:U,loadFilesystemNotas:B,selectDirectory:O,getFilesystemOnlyNotas:Z}=va();X(()=>m.rootItems.length>0||N.value.length>0);const q=X(()=>{if(!V.value)return m.rootItems;const r=Z(m.rootItems);return[...m.rootItems,...r]}),M=async(r=!1)=>{try{c.value=null,r?n.value=!0:o.value=!0,await m.loadNotas(),V.value&&(await U(),await B()),p.value=0,r&&D("Notas refreshed successfully")}catch(_){console.error("Failed to load notas:",_),c.value=_ instanceof Error?_.message:"Failed to load notas",p.value<Fa?(p.value++,setTimeout(()=>M(),1e3*p.value)):D("Failed to load notas. Please try again later.")}finally{o.value=!1,n.value=!1}},j=()=>{p.value=0,M()},Q=async()=>{await O()&&await M(!0)};Te(()=>{M()}),ie(()=>m.rootItems,()=>{o.value&&(o.value=!1)},{immediate:!0});const h=()=>{P(),D("Filters cleared")};return Xs(()=>{}),(r,_)=>(u(),$("div",ya,[s("main",ha,[s("div",wa,[s("div",xa,[s("div",_a,[s("div",ba,[t(zt,{onCreateNota:e(d),onSelectDirectory:Q,"is-filesystem-mode":e(V),"has-directory-access":e(H),"directory-name":e(R)},null,8,["onCreateNota","is-filesystem-mode","has-directory-access","directory-name"])])]),s("div",ka,[c.value&&!o.value?(u(),x(e(tt),{key:0,variant:"destructive",class:"mb-4"},{default:a(()=>[t(e(Zs),{class:"h-4 w-4"}),t(e(et),{class:"flex items-center justify-between w-full"},{default:a(()=>[s("span",null,v(c.value),1),t(e(S),{variant:"outline",size:"sm",onClick:j,class:"ml-4"},{default:a(()=>[t(e(st),{class:"h-3 w-3 mr-1"}),_[4]||(_[4]=F(" Retry "))]),_:1})]),_:1})]),_:1})):I("",!0),s("div",Na,[t(pa,{"is-loading":o.value||e(b),"view-type":e(w),"show-favorites":e(f),"search-query":e(C),"selected-tag":e(A),notas:q.value,"filesystem-notas":e(N),"is-filesystem-mode":e(V),"has-directory-access":e(H),onCreateNota:e(d),"onUpdate:selectedTag":_[0]||(_[0]=E=>A.value=E),"onUpdate:viewType":_[1]||(_[1]=E=>w.value=E),"onUpdate:searchQuery":_[2]||(_[2]=E=>C.value=E),"onUpdate:showFavorites":_[3]||(_[3]=E=>f.value=E),onClearFilters:h},null,8,["is-loading","view-type","show-favorites","search-query","selected-tag","notas","filesystem-notas","is-filesystem-mode","has-directory-access","onCreateNota"])])])])])])]))}}),Ma=Be(Sa,[["__scopeId","data-v-6c2a95c1"]]);export{Ma as default};
